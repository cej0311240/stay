{"ast":null,"code":"import{createContext,useContext,useEffect,useState}from\"react\";import{fetchParkingSpots,fetchParkingStatusSummary,enterParking,registConfirm,exitParking,confirmExit,adjustment}from\"../api/parkingAPI\";/* =====================================================\n    1) Context 채널 만들기\n    ===================================================== */import{jsx as _jsx}from\"react/jsx-runtime\";const ParkingContext=/*#__PURE__*/createContext(null);/* =====================================================\n    2) Provider (현황판 관련 상태 + 함수)\n    ===================================================== */const ParkingProvider=_ref=>{let{children}=_ref;/* -----------------------------------------------------\n        ✅ 상태(state) 모음\n        - 현황판 UI에 필요한 값들\n    ----------------------------------------------------- *///  주차 자리 전체 리스트 (APT/STORE 포함)\n//    -> 그리드 카드(자리별 상태) 만들 때 사용\nconst[spots,setSpots]=useState([]);//  요약 정보 (총/주차중/빈자리)\n//    -> 상단 요약 카드(총 36면 / 주차중 20 / 빈자리 16) 같은 거 만들 때 사용\nconst[summary,setSummary]=useState({total:0,occupied:0,empty:0});//  로딩 (선택)\nconst[loading,setLoading]=useState(false);/* -----------------------------------------------------\n        ✅ 1) 현황판 전체 자리 조회\n    ----------------------------------------------------- *//**\n   * ✅ [현황판 페이지 - 자리 그리드용]\n   * - parking_spots 전체 조회\n   * - APT/STORE 섞여서 오므로, 프론트에서 zone으로 나눠서 보여주면 됨\n   *\n   * ✅ 사용 예시\n   * const { spots, loadSpots } = useParkingBoard();\n   * useEffect(()=>{ loadSpots(); }, []);\n   */const loadSpots=async()=>{try{setLoading(true);const data=await fetchParkingSpots();setSpots(data);return{ok:true};}catch(e){console.error(e);return{ok:false,message:e.message};}finally{setLoading(false);}};/* -----------------------------------------------------\n            ✅ 2) 현황판 요약 조회 (총/주차중/빈자리)\n        ----------------------------------------------------- *//**\n     * ✅ [현황판 페이지 - 상단 요약 카드용]\n     * - total, occupied, empty 계산해서 반환\n     *\n     * ✅ 사용 예시\n     * const { summary, loadSummary } = useParkingBoard();\n     * useEffect(()=>{ loadSummary(); }, []);\n     */const loadSummary=async()=>{try{const data=await fetchParkingStatusSummary();setSummary(data);return{ok:true};}catch(e){console.error(e);return{ok:false,message:e.message};}};/* -----------------------------------------------------\n            ✅ 3) 한 번에 갱신하기 (버튼/주기적 갱신용)\n        ----------------------------------------------------- *//**\n     * ✅ [현황판 새로고침 버튼 또는 주기적 갱신용]\n     * - spots + summary 둘 다 최신으로 갱신\n     *\n     * ✅ 사용 예시\n     * const { refreshBoard } = useParkingBoard();\n     * <button onClick={refreshBoard}>새로고침</button>\n     */const refreshBoard=async()=>{await loadSpots();await loadSummary();};//추가작성 부분\nconst regist_check=async carNum=>{try{const data=await registConfirm(carNum);return data;}catch(error){console.error(error);}};const adjustment_check=async carNum=>{try{const data=await adjustment(carNum);return data;}catch(error){console.error(error);}};const enter_car=async carNum=>{const cartype={APT:\"입주민\",STORE:\"사업자\",DAILY:\"예약방문\",PERIOD:\"장기방문\",VISIT:\"일반방문\"};try{const regist=await registConfirm(carNum);const{targetID,statMsg}=await enterParking(carNum,regist.parking_zone);if(statMsg!=\"\"){alert(statMsg);}else{alert(\"\".concat(cartype[regist.car_Type],\"\\uC785\\uB2C8\\uB2E4\").concat(regist.parking_zone,\"\\uAD6C\\uC5ED\").concat(targetID,\"\\uC5D0 \\uC8FC\\uCC28\\uC131\\uACF5\"));}}catch(error){alert(error);console.error(error);}};// const exit_car = async (carNum) => {\n//     try{\n//         //출차처리\n//         const {registerTime,spot_id} = await exitParking(carNum);\n//         const result = window.confirm(`주차시간 : ${registerTime}`);\n//         if(result) {\n//             //확인버튼 : 출차를 하겠음\n//             await confirmExit(spot_id);\n//             alert(\"안녕히 가세요!\");\n//             refreshBoard();\n//         }\n//     }catch(error){\n//         console.error(error);\n//     }\n// }\nconst exit_car=async carNum=>{try{const{registerTime,spot_id,spot_type,need_settlement}=await exitParking(carNum);if(spot_type===\"APT\"){await confirmExit(spot_id,carNum);alert(\"입주민 구역 출차 : 안녕히가세요\");}else{if(need_settlement){await confirmExit(spot_id,carNum);alert(\"정산완료 : 안녕히가세요\");}else{alert(\"주차시간 : \"+registerTime+\"분\\n정산이 필요합니다.\");if(window.confirm(\"결제 하시겠습니까?\")){await confirmExit(spot_id,carNum);alert(\"안녕히 가세요\");}}}//강제출차\n// confirmExit(\"G-3\");\n}catch(error){console.error(error);}};// ✅ 처음 화면 들어왔을 때 자동 조회 (강사님 스타일)\nuseEffect(()=>{refreshBoard();},[]);/* -----------------------------------------------------\n            ✅ Context value: 페이지에서 꺼내 쓰는 목록\n        ----------------------------------------------------- */const value={// state\nspots,summary,loading,// actions\nloadSpots,loadSummary,refreshBoard,enter_car,exit_car,regist_check,adjustment_check};return/*#__PURE__*/_jsx(ParkingContext.Provider,{value:value,children:children});};export default ParkingProvider;/* =====================================================\n    3) Hook export (페이지에서 이렇게 꺼내 씀)\n    ===================================================== */export const useParkingBoard=()=>useContext(ParkingContext);","map":{"version":3,"names":["createContext","useContext","useEffect","useState","fetchParkingSpots","fetchParkingStatusSummary","enterParking","registConfirm","exitParking","confirmExit","adjustment","jsx","_jsx","ParkingContext","ParkingProvider","_ref","children","spots","setSpots","summary","setSummary","total","occupied","empty","loading","setLoading","loadSpots","data","ok","e","console","error","message","loadSummary","refreshBoard","regist_check","carNum","adjustment_check","enter_car","cartype","APT","STORE","DAILY","PERIOD","VISIT","regist","targetID","statMsg","parking_zone","alert","concat","car_Type","exit_car","registerTime","spot_id","spot_type","need_settlement","window","confirm","value","Provider","useParkingBoard"],"sources":["D:/포폴 사용/stay/src/contexts/ParkingContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\n\nimport {\n    fetchParkingSpots,\n    fetchParkingStatusSummary,\n    enterParking,\n    registConfirm,\n    exitParking,\n    confirmExit,\n    adjustment,\n} from \"../api/parkingAPI\";\n\n/* =====================================================\n    1) Context 채널 만들기\n    ===================================================== */\nconst ParkingContext = createContext(null);\n\n/* =====================================================\n    2) Provider (현황판 관련 상태 + 함수)\n    ===================================================== */\nconst ParkingProvider = ({ children }) => {\n    /* -----------------------------------------------------\n        ✅ 상태(state) 모음\n        - 현황판 UI에 필요한 값들\n    ----------------------------------------------------- */\n\n  //  주차 자리 전체 리스트 (APT/STORE 포함)\n  //    -> 그리드 카드(자리별 상태) 만들 때 사용\n    const [spots, setSpots] = useState([]);\n\n  //  요약 정보 (총/주차중/빈자리)\n  //    -> 상단 요약 카드(총 36면 / 주차중 20 / 빈자리 16) 같은 거 만들 때 사용\n    const [summary, setSummary] = useState({ total: 0, occupied: 0, empty: 0 });\n\n  //  로딩 (선택)\n    const [loading, setLoading] = useState(false);\n\n    /* -----------------------------------------------------\n        ✅ 1) 현황판 전체 자리 조회\n    ----------------------------------------------------- */\n\n    /**\n   * ✅ [현황판 페이지 - 자리 그리드용]\n   * - parking_spots 전체 조회\n   * - APT/STORE 섞여서 오므로, 프론트에서 zone으로 나눠서 보여주면 됨\n   *\n   * ✅ 사용 예시\n   * const { spots, loadSpots } = useParkingBoard();\n   * useEffect(()=>{ loadSpots(); }, []);\n   */\n    const loadSpots = async () => {\n        try {\n        setLoading(true);\n        const data = await fetchParkingSpots();\n        setSpots(data);\n        return { ok: true };\n        } catch (e) {\n        console.error(e);\n        return { ok: false, message: e.message };\n        } finally {\n        setLoading(false);\n        }\n    };\n\n    /* -----------------------------------------------------\n            ✅ 2) 현황판 요약 조회 (총/주차중/빈자리)\n        ----------------------------------------------------- */\n\n    /**\n     * ✅ [현황판 페이지 - 상단 요약 카드용]\n     * - total, occupied, empty 계산해서 반환\n     *\n     * ✅ 사용 예시\n     * const { summary, loadSummary } = useParkingBoard();\n     * useEffect(()=>{ loadSummary(); }, []);\n     */\n    const loadSummary = async () => {\n        try {\n        const data = await fetchParkingStatusSummary();\n        setSummary(data);\n        return { ok: true };\n        } catch (e) {\n        console.error(e);\n        return { ok: false, message: e.message };\n        }\n    };\n\n    /* -----------------------------------------------------\n            ✅ 3) 한 번에 갱신하기 (버튼/주기적 갱신용)\n        ----------------------------------------------------- */\n    /**\n     * ✅ [현황판 새로고침 버튼 또는 주기적 갱신용]\n     * - spots + summary 둘 다 최신으로 갱신\n     *\n     * ✅ 사용 예시\n     * const { refreshBoard } = useParkingBoard();\n     * <button onClick={refreshBoard}>새로고침</button>\n     */\n    const refreshBoard = async () => {\n        await loadSpots();\n        await loadSummary();\n    };\n\n    //추가작성 부분\n    const regist_check = async (carNum) => {\n        try {\n        const data = await registConfirm(carNum);\n        return data;\n        } catch (error) {\n        console.error(error);\n        }\n    };\n    const adjustment_check = async (carNum) => {\n        try {\n        const data = await adjustment(carNum);\n        return data;\n        } catch (error) {\n        console.error(error);\n        }\n    };\n\n\n    const enter_car = async (carNum) => {\n        const cartype = {\n        APT: \"입주민\",\n        STORE: \"사업자\",\n        DAILY: \"예약방문\",\n        PERIOD: \"장기방문\",\n        VISIT: \"일반방문\",\n        };\n        try {\n        const regist = await registConfirm(carNum);\n        const {targetID,statMsg} = await enterParking(carNum, regist.parking_zone);\n        if(statMsg!=\"\"){\n            alert(statMsg);\n        }else{\n            alert(\n            `${cartype[regist.car_Type]}입니다${\n            regist.parking_zone\n            }구역${targetID}에 주차성공`\n            );\n        }\n        \n        } catch (error) {\n            alert(error);\n            console.error(error);\n        }\n    };\n\n    // const exit_car = async (carNum) => {\n    //     try{\n    //         //출차처리\n    //         const {registerTime,spot_id} = await exitParking(carNum);\n    //         const result = window.confirm(`주차시간 : ${registerTime}`);\n    //         if(result) {\n    //             //확인버튼 : 출차를 하겠음\n    //             await confirmExit(spot_id);\n    //             alert(\"안녕히 가세요!\");\n    //             refreshBoard();\n    //         }\n\n    //     }catch(error){\n    //         console.error(error);\n    //     }\n    // }\n\n    const exit_car = async (carNum) => {\n        try {\n            const { registerTime, spot_id,spot_type,need_settlement} = await exitParking(\n                carNum\n            );\n            if(spot_type===\"APT\"){\n                    await confirmExit(spot_id,carNum);\n                    alert(\"입주민 구역 출차 : 안녕히가세요\");\n                }else{\n                    if(need_settlement){\n                        await confirmExit(spot_id,carNum);\n                        alert(\"정산완료 : 안녕히가세요\");\n                    }else{\n                        alert(\"주차시간 : \"+ registerTime + \"분\\n정산이 필요합니다.\");\n                        if(window.confirm(\"결제 하시겠습니까?\")){\n                            await confirmExit(spot_id,carNum);\n                            alert(\"안녕히 가세요\");\n                        }\n                        \n                    }\n                    \n            }\n\n        \n        \n        //강제출차\n        // confirmExit(\"G-3\");\n\n\n        } catch (error) {\n            console.error(error);\n        }\n    };\n\n    // ✅ 처음 화면 들어왔을 때 자동 조회 (강사님 스타일)\n    useEffect(() => {\n        refreshBoard();\n    }, []);\n\n    /* -----------------------------------------------------\n            ✅ Context value: 페이지에서 꺼내 쓰는 목록\n        ----------------------------------------------------- */\n    const value = {\n        // state\n        spots,\n        summary,\n        loading,\n        \n\n        // actions\n        loadSpots,\n        loadSummary,\n        refreshBoard,\n        enter_car,\n        exit_car,\n        regist_check,\n        adjustment_check,\n    };\n\n    return (\n        <ParkingContext.Provider value={value}>{children}</ParkingContext.Provider>\n    );\n};\n\nexport default ParkingProvider;\n\n/* =====================================================\n    3) Hook export (페이지에서 이렇게 꺼내 씀)\n    ===================================================== */\nexport const useParkingBoard = () => useContext(ParkingContext);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}