{"ast":null,"code":"import{createContext,useContext,useEffect,useState}from\"react\";import{fetchAdminHeader,fetchApprovalRequests,approveProfile,fetchAdminSettlementList,approveSettlement}from\"../api/adminApi\";/* =====================================================\n    1) Context 채널 만들기 \n    ===================================================== */import{jsx as _jsx}from\"react/jsx-runtime\";const AdminContext=/*#__PURE__*/createContext(null);/* =====================================================\n    2) Provider (관리자 관련 상태 + 함수)\n    ===================================================== */const AdminProvider=_ref=>{let{children}=_ref;/* -----------------------------------------------------\n        ✅ 상태(state) 모음\n        - 관리자 페이지에서 화면 그릴 때 필요한 값들\n    ----------------------------------------------------- *///  관리자 헤더 (관리자 이름 표시용)\nconst[adminHeader,setAdminHeader]=useState(null);//  승인요청 카드 목록 (가입했지만 승인 안 된 사용자)\nconst[approvalList,setApprovalList]=useState([]);// 상가 정산 카드 목록 (할인권 누적 있는 상가만)\nconst[settlementList,setSettlementList]=useState([]);// 로딩 (버튼 누를 때 UX)\nconst[loading,setLoading]=useState(false);/* -----------------------------------------------------\n        ✅ 1) 관리자 헤더 (관리자 페이지 상단)\n    ----------------------------------------------------- *//**\n     * ✅ [관리자 공통 Header]\n     * - 관리자 이름 표시용\n     *\n     * ✅ 사용 예시 (관리자 레이아웃 컴포넌트)\n     * const { adminHeader, loadAdminHeader } = useAdmin();\n     * useEffect(()=>{ loadAdminHeader(adminId); }, []);\n     */const loadAdminHeader=async adminProfileId=>{try{setLoading(true);const header=await fetchAdminHeader(adminProfileId);setAdminHeader(header);return{ok:true};}catch(e){console.error(e);return{ok:false,message:e.message};}finally{setLoading(false);}};/* -----------------------------------------------------\n        ✅ 2) 승인요청 리스트 (관리자 - 승인요청 페이지)\n    ----------------------------------------------------- *//**\n     * ✅ [관리자 - 승인요청 리스트 불러오기]\n     * - profiles.is_approved = false 인 사용자만\n     *\n     * ✅ 사용 예시 (승인요청 페이지)\n     * const { approvalList, loadApprovalList } = useAdmin();\n     * useEffect(()=>{ loadApprovalList(); }, []);\n     */const loadApprovalList=async()=>{try{setLoading(true);const list=await fetchApprovalRequests();setApprovalList(list);return{ok:true};}catch(e){console.error(e);return{ok:false,message:e.message};}finally{setLoading(false);}};/**\n     * ✅ [관리자 - 승인 버튼 클릭]\n     * - 해당 사용자 profiles.is_approved = true 로 변경\n     * - 승인 후 목록 다시 불러와서 UI 갱신\n     *\n     * ✅ 사용 예시 (승인요청 카드의 승인버튼)\n     * const { approveUser } = useAdmin();\n     * await approveUser(profile_id);\n     */const approveUser=async profileId=>{try{setLoading(true);await approveProfile(profileId);await loadApprovalList();// ✅ 승인 후 화면 갱신\nreturn{ok:true};}catch(e){console.error(e);return{ok:false,message:e.message};}finally{setLoading(false);}};/* -----------------------------------------------------\n        ✅ 3) 상가 정산 리스트 (관리자 - 상가 정산리스트 페이지)\n    ----------------------------------------------------- *//**\n     * ✅ [관리자 - 상가 정산 카드 리스트 불러오기]\n     * - parking_discounts.discount_sum > 0 인 STORE만 카드로 보여줌\n     *\n     * ✅ 사용 예시 (상가정산리스트 페이지)\n     * const { settlementList, loadSettlementList } = useAdmin();\n     * useEffect(()=>{ loadSettlementList(); }, []);\n     */const loadSettlementList=async()=>{try{setLoading(true);const cards=await fetchAdminSettlementList();setSettlementList(cards);return{ok:true};}catch(e){console.error(e);return{ok:false,message:e.message};}finally{setLoading(false);}};/**\n     * ✅ [관리자 - 정산 승인 버튼 클릭]\n     * - 승인하면 해당 상가 discount_sum을 0으로 초기화\n     * - 승인 후 리스트 다시 불러와서 카드 사라지게 갱신\n     *\n     * ✅ 사용 예시 (정산 카드의 승인 버튼)\n     * const { approveStoreSettlement } = useAdmin();\n     * const res = await approveStoreSettlement(store_profile_id);\n     * if(res.ok) alert(\"정산 승인 완료\");\n     */const approveStoreSettlement=async storeProfileId=>{try{setLoading(true);const res=await approveSettlement(storeProfileId);// ✅ 승인 성공이면 리스트 새로고침해서 카드 제거\nif(res.ok){await loadSettlementList();}return res;// { ok, settled_qty, settled_amount, settled_date } 또는 { ok:false, message }\n}catch(e){console.error(e);return{ok:false,message:e.message};}finally{setLoading(false);}};/* -----------------------------------------------------\n        ✅ Context value (관리자 페이지에서 꺼내 쓰는 목록)\n    ----------------------------------------------------- */const value={// state\nadminHeader,approvalList,settlementList,loading,// header\nloadAdminHeader,// approval\nloadApprovalList,approveUser,// settlement\nloadSettlementList,approveStoreSettlement};return/*#__PURE__*/_jsx(AdminContext.Provider,{value:value,children:children});};export default AdminProvider;/* =====================================================\n    3) Hook export\n    ===================================================== */export const useAdmin=()=>useContext(AdminContext);","map":{"version":3,"names":["createContext","useContext","useEffect","useState","fetchAdminHeader","fetchApprovalRequests","approveProfile","fetchAdminSettlementList","approveSettlement","jsx","_jsx","AdminContext","AdminProvider","_ref","children","adminHeader","setAdminHeader","approvalList","setApprovalList","settlementList","setSettlementList","loading","setLoading","loadAdminHeader","adminProfileId","header","ok","e","console","error","message","loadApprovalList","list","approveUser","profileId","loadSettlementList","cards","approveStoreSettlement","storeProfileId","res","value","Provider","useAdmin"],"sources":["D:/포폴 사용/stay/src/contexts/AdminContext.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from \"react\";\n\nimport {\n    fetchAdminHeader,\n    fetchApprovalRequests,\n    approveProfile,\n    fetchAdminSettlementList,\n    approveSettlement,\n    } from \"../api/adminApi\";\n\n    /* =====================================================\n    1) Context 채널 만들기 \n    ===================================================== */\n    const AdminContext = createContext(null);\n\n    /* =====================================================\n    2) Provider (관리자 관련 상태 + 함수)\n    ===================================================== */\n    const AdminProvider = ({ children }) => {\n    /* -----------------------------------------------------\n        ✅ 상태(state) 모음\n        - 관리자 페이지에서 화면 그릴 때 필요한 값들\n    ----------------------------------------------------- */\n\n    //  관리자 헤더 (관리자 이름 표시용)\n    const [adminHeader, setAdminHeader] = useState(null);\n\n    //  승인요청 카드 목록 (가입했지만 승인 안 된 사용자)\n    const [approvalList, setApprovalList] = useState([]);\n\n    // 상가 정산 카드 목록 (할인권 누적 있는 상가만)\n    const [settlementList, setSettlementList] = useState([]);\n\n    // 로딩 (버튼 누를 때 UX)\n    const [loading, setLoading] = useState(false);\n\n    /* -----------------------------------------------------\n        ✅ 1) 관리자 헤더 (관리자 페이지 상단)\n    ----------------------------------------------------- */\n\n    /**\n     * ✅ [관리자 공통 Header]\n     * - 관리자 이름 표시용\n     *\n     * ✅ 사용 예시 (관리자 레이아웃 컴포넌트)\n     * const { adminHeader, loadAdminHeader } = useAdmin();\n     * useEffect(()=>{ loadAdminHeader(adminId); }, []);\n     */\n        const loadAdminHeader = async (adminProfileId) => {\n            try {\n            setLoading(true);\n            const header = await fetchAdminHeader(adminProfileId);\n            setAdminHeader(header);\n            return { ok: true };\n            } catch (e) {\n            console.error(e);\n            return { ok: false, message: e.message };\n            } finally {\n            setLoading(false);\n            }\n        };\n\n    /* -----------------------------------------------------\n        ✅ 2) 승인요청 리스트 (관리자 - 승인요청 페이지)\n    ----------------------------------------------------- */\n\n    /**\n     * ✅ [관리자 - 승인요청 리스트 불러오기]\n     * - profiles.is_approved = false 인 사용자만\n     *\n     * ✅ 사용 예시 (승인요청 페이지)\n     * const { approvalList, loadApprovalList } = useAdmin();\n     * useEffect(()=>{ loadApprovalList(); }, []);\n     */\n    const loadApprovalList = async () => {\n        try {\n        setLoading(true);\n        const list = await fetchApprovalRequests();\n        setApprovalList(list);\n        return { ok: true };\n        } catch (e) {\n        console.error(e);\n        return { ok: false, message: e.message };\n        } finally {\n        setLoading(false);\n        }\n    };\n\n    /**\n     * ✅ [관리자 - 승인 버튼 클릭]\n     * - 해당 사용자 profiles.is_approved = true 로 변경\n     * - 승인 후 목록 다시 불러와서 UI 갱신\n     *\n     * ✅ 사용 예시 (승인요청 카드의 승인버튼)\n     * const { approveUser } = useAdmin();\n     * await approveUser(profile_id);\n     */\n    const approveUser = async (profileId) => {\n        try {\n        setLoading(true);\n        await approveProfile(profileId);\n        await loadApprovalList(); // ✅ 승인 후 화면 갱신\n        return { ok: true };\n        } catch (e) {\n        console.error(e);\n        return { ok: false, message: e.message };\n        } finally {\n        setLoading(false);\n        }\n    };\n\n    /* -----------------------------------------------------\n        ✅ 3) 상가 정산 리스트 (관리자 - 상가 정산리스트 페이지)\n    ----------------------------------------------------- */\n\n    /**\n     * ✅ [관리자 - 상가 정산 카드 리스트 불러오기]\n     * - parking_discounts.discount_sum > 0 인 STORE만 카드로 보여줌\n     *\n     * ✅ 사용 예시 (상가정산리스트 페이지)\n     * const { settlementList, loadSettlementList } = useAdmin();\n     * useEffect(()=>{ loadSettlementList(); }, []);\n     */\n    const loadSettlementList = async () => {\n        try {\n        setLoading(true);\n        const cards = await fetchAdminSettlementList();\n        setSettlementList(cards);\n        return { ok: true };\n        } catch (e) {\n        console.error(e);\n        return { ok: false, message: e.message };\n        } finally {\n        setLoading(false);\n        }\n    };\n\n    /**\n     * ✅ [관리자 - 정산 승인 버튼 클릭]\n     * - 승인하면 해당 상가 discount_sum을 0으로 초기화\n     * - 승인 후 리스트 다시 불러와서 카드 사라지게 갱신\n     *\n     * ✅ 사용 예시 (정산 카드의 승인 버튼)\n     * const { approveStoreSettlement } = useAdmin();\n     * const res = await approveStoreSettlement(store_profile_id);\n     * if(res.ok) alert(\"정산 승인 완료\");\n     */\n    const approveStoreSettlement = async (storeProfileId) => {\n        try {\n        setLoading(true);\n        const res = await approveSettlement(storeProfileId);\n\n        // ✅ 승인 성공이면 리스트 새로고침해서 카드 제거\n        if (res.ok) {\n            await loadSettlementList();\n        }\n\n        return res; // { ok, settled_qty, settled_amount, settled_date } 또는 { ok:false, message }\n        } catch (e) {\n        console.error(e);\n        return { ok: false, message: e.message };\n        } finally {\n        setLoading(false);\n        }\n    };\n\n    /* -----------------------------------------------------\n        ✅ Context value (관리자 페이지에서 꺼내 쓰는 목록)\n    ----------------------------------------------------- */\n    const value = {\n        // state\n        adminHeader,\n        approvalList,\n        settlementList,\n        loading,\n\n        // header\n        loadAdminHeader,\n\n        // approval\n        loadApprovalList,\n        approveUser,\n\n        // settlement\n        loadSettlementList,\n        approveStoreSettlement,\n    };\n\n    return <AdminContext.Provider value={value}>{children}</AdminContext.Provider>;\n    };\n\n    export default AdminProvider;\n\n    /* =====================================================\n    3) Hook export\n    ===================================================== */\n    export const useAdmin = () => useContext(AdminContext);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}